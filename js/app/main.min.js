$(document).ready(()=>{function t(t,e){$(".error").remove(),$(e).after(`<span class="error">${t}</span>`)}function e(t,e,s){$.ajax({url:url+"/history",type:"post",dataType:"json",data:{userName:t,history:{status:s,time:a(),count:e}}})}function a(){const t=new Date;let e=t.getDate(),a=t.getMonth()+1;return e<10&&(e="0"+e),a<10&&(a="0"+a),`${a}-${e}-${t.getFullYear()} ${t.getHours()}:${t.getMinutes()}`}$("#start").click(e=>{e.preventDefault(),""!==$("#userName").val()?$.ajax({url:url+"/register",type:"post",dataType:"json",data:{userName:$("#userName").val()}}).done(()=>{$("#welcomePage").hide(),$("#gamePage").show(),$("#greeting").text("Hi "+$("#userName").val()).attr("data-name",$("#userName").val())}).fail(e=>{t(e.responseJSON.message,"#userName")}):t("Please enter userName","#userName")}),$("select#cardsCount").change(function(){!function(t,a){$.ajax({url:url+"/numbers",type:"get",dataType:"json",data:{cardCount:t}}).done((t,s,r)=>{$("#cardsScreen").html("");let d="";t.length<=0?$("#play").hide():$("#play").show();const l=t.numbers;for(let t=0;t<l.length;t++)d=`<div class=" flippable-card opened" data-card=${t} tabindex="1">\n\t\t\t\t <div class="flippable-card-inner">\n\t\t\t\t <div class="flippable-card-front">\n\t\t\t\t <p class="card-number" >${l[t]}</p>\n\t\t\t   </div>\n\t\t\t\t   <div class="flippable-card-back">\n\t\t\t\t   </div>\n\t\t\t\t </div>\n\t\t\t   </div>`,$("#cardsScreen").append(d);const n=[...l];l.sort((t,e)=>t-e),$(".flippable-card").bind("keypress",function(t){var e=t.keyCode?t.keyCode:t.which;"13"==e&&$(this).trigger("click")}),$(".flippable-card").bind("click keypress",function(t){if($(this).hasClass("closed")){$(this).addClass("opened").removeClass("closed");const t=l.shift(),s=n[$(this).attr("data-card")];t==s?($(this).find("p").text(n[$(this).attr("data-card")]),0==l.length&&($("#resultMessage").text("Congratulations! You win :)").addClass("success"),e(a,n.length,"won"))):($(this).addClass("wrong-card"),$("#resultMessage").text("Oops!! Better luck next time.").addClass("error"),$(".flippable-card").removeClass("closed").addClass("opened"),$(".flippable-card").each(function(t){$(this).find("p").text(n[$(this).attr("data-card")])}),e(a,n.length,"failed"))}})})}($(this).children("option:selected").val(),$("#userName").val())}),$("#play").click(()=>{$("#cardsCount").attr("disabled",!0),$("#play").hide(),""!==$("#cardsCount").val()&&($(".flippable-card").removeClass("opened").addClass("closed").find("p").text(""),$(".flippable-card:first-child").focus())}),$("#history").click(()=>{$.ajax({url:url+"/history",type:"get",dataType:"json",data:{userName:$("#greeting").attr("data-name")}}).done(t=>{let e='<table class="table"><thead><th>Date</th><th>Card Count</th><th>Status</th></thead>';t.forEach(t=>{e+=`<tr><td>${t.time}</td><td>${t.count}</td><td>${t.status}</td></tr>`}),e+="</table>",$("#historyData").html(e)})}),$("#reset").click(()=>{$("#cardsCount").attr("disabled",!1).val("Select"),$("#resultMessage").text(""),$("#cardsScreen").empty(),$("#play").hide()})});